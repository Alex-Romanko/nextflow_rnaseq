if (params.UMI) {
    process {
	withName: 'STAR_ALIGN' {
	    // ext.args = '--clip5pNbases 2,2 --clip3pNbases 10,0'
	}

	withName: 'FASTP_TRIM_CLIP' {
	    ext.args   = {
		[
		    "-Q -L -A",
		    "--trim_front1 2",
		    "--trim_front2 2",
		    "--trim_tail1 10",
		    "--trim_tail2 0"
		].join(' ').trim()
	    }
	}

	withName: 'UMI_DEDUP_GN' {
	    ext.args = '--multimapping-detection-method=NH'
	}

	withName: 'UMI_DEDUP_TR' {

	    ext.args   = {
		[
		    "--multimapping-detection-method=NH",
		    "--chimeric-pairs=discard",
		    "--unpaired-reads=discard"
		].join(' ').trim()
	    }
	}
	withName: 'PICARD_SORTSAM' {
	    ext.args   = {
		[
		    "--SORT_ORDER queryname",
		    "--CREATE_INDEX true",
		    "--TMP_DIR ./tmp"
		].join(' ').trim()
	    }
	    ext.bam_label = "UMI_dedup_QuerySorted"
	}
    }
}

process {
    withName: 'STAR_ALIGN' {
	// ext.args = '--clip5pNbases 2,2 --clip3pNbases 10,0'
    }
    withName: 'FASTP_TRIM_X' {
	ext.args   = {
	    [
		"-Q -L -A",
		"--trim_poly_g",
		"--poly_g_min_len 10",
		"--trim_poly_x",
		"--poly_x_min_len 10"
	    ].join(' ').trim()
	}
    }
}
